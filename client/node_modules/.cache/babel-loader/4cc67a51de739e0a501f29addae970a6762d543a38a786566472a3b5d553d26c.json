{"ast":null,"code":"import _toConsumableArray from\"/home/mulubrhan/alx/social_media_for_alx/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"/home/mulubrhan/alx/social_media_for_alx/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/mulubrhan/alx/social_media_for_alx/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useEffect,useState}from\"react\";import{UserContext}from\"../../App\";import{useParams}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Profile=function Profile(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),userProfile=_useState2[0],setProfile=_useState2[1];var _useContext=useContext(UserContext),state=_useContext.state,dispatch=_useContext.dispatch;var user=JSON.parse(localStorage.getItem(\"user\"));var _useParams=useParams(),userid=_useParams.userid;var _useState3=useState(state?!state.following.includes(userid):true),_useState4=_slicedToArray(_useState3,2),showfollow=_useState4[0],setShowFollow=_useState4[1];useEffect(function(){fetch(\"/user/\".concat(userid),{headers:{\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")}}).then(function(res){return res.json();}).then(function(result){console.log(result);setProfile(result);});},[]);var folloUser=function folloUser(){fetch('/follow',{method:\"put\",body:JSON.stringify({followId:userid}),headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")}}).then(function(res){return res.json();}).then(function(data){console.log(data);dispatch({type:\"UPDATE\",payload:{following:data.following,followers:data.followers}});localStorage.setItem(\"user\",JSON.stringify(data));setProfile(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{user:_objectSpread(_objectSpread({},prevState.user),{},{followers:[].concat(_toConsumableArray(prevState.user.followers),[data._id])})});});});setShowFollow(false);};var unfolloUser=function unfolloUser(){fetch('/unfollow',{method:\"put\",body:JSON.stringify({unfollowId:userid}),headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")}}).then(function(res){return res.json();}).then(function(data){console.log(data);dispatch({type:\"UPDATE\",payload:{following:data.following,followers:data.followers}});localStorage.setItem(\"user\",JSON.stringify(data));setProfile(function(prevState){var updatedFollowers=prevState.user.followers.filter(function(followerId){return followerId!==data._id;});return _objectSpread(_objectSpread({},prevState),{},{user:_objectSpread(_objectSpread({},prevState.user),{},{followers:updatedFollowers})});});});setShowFollow(true);};return/*#__PURE__*/_jsx(_Fragment,{children:userProfile?/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:\"550px\",margin:\"0px auto\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:\"space-around\",margin:\"18px 0px\",borderBottom:\"1px solid grey\"},children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"img\",{style:{width:\"160px\",height:\"160px\",borderRadius:\"80px\"},src:userProfile.user.pic})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{children:userProfile.user.name}),/*#__PURE__*/_jsx(\"h5\",{children:userProfile.user.email}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\",width:\"108%\"},children:[/*#__PURE__*/_jsx(\"h5\",{children:\"40 Posts\"}),/*#__PURE__*/_jsxs(\"h5\",{children:[userProfile.user.followers.length,\" folowers\"]}),/*#__PURE__*/_jsxs(\"h5\",{children:[userProfile.user.following.length,\" following\"]})]}),userProfile.user.followers.includes(user._id)?/*#__PURE__*/_jsx(\"button\",{style:{margin:\"10px\"},className:\"btn waves-effect waves-light #64b5f6 blue darken-1\",onClick:function onClick(){return unfolloUser();},children:\"Unfollow\"}):/*#__PURE__*/_jsx(\"button\",{style:{margin:\"10px\"},className:\"btn waves-effect waves-light #64b5f6 blue darken-1\",onClick:function onClick(){return folloUser();},children:\"Follow\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"gallery\",children:userProfile.posts.map(function(item){return/*#__PURE__*/_jsx(\"img\",{className:\"item\",src:item.photo,alt:item.title},item._id);})})]}):/*#__PURE__*/_jsx(\"h2\",{children:\"loading...!\"})});};export default Profile;","map":{"version":3,"names":["React","useContext","useEffect","useState","UserContext","useParams","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Profile","_useState","_useState2","_slicedToArray","userProfile","setProfile","_useContext","state","dispatch","user","JSON","parse","localStorage","getItem","_useParams","userid","_useState3","following","includes","_useState4","showfollow","setShowFollow","fetch","concat","headers","then","res","json","result","console","log","folloUser","method","body","stringify","followId","data","type","payload","followers","setItem","prevState","_objectSpread","_toConsumableArray","_id","unfolloUser","unfollowId","updatedFollowers","filter","followerId","children","style","maxWidth","margin","display","justifyContent","borderBottom","width","height","borderRadius","src","pic","name","email","length","className","onClick","posts","map","item","photo","alt","title"],"sources":["/home/mulubrhan/alx/social_media_for_alx/client/src/components/screens/UserProfile.js"],"sourcesContent":["import React,{useContext, useEffect, useState} from \"react\";\nimport { UserContext } from \"../../App\";\nimport {useParams} from 'react-router-dom'\n\nconst Profile = ()=>{\n    const [userProfile,setProfile] = useState(null)\n    const { state, dispatch } = useContext(UserContext);\n    const user = JSON.parse(localStorage.getItem(\"user\"))\n    const {userid} = useParams()\n    const [showfollow,setShowFollow] = useState(state?!state.following.includes(userid):true)\n    useEffect(()=>{\n        fetch(`/user/${userid}`,{\n            headers:{\n                \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\n            }\n        }).then(res=>res.json())\n        .then(result=>{\n            console.log(result)\n            setProfile(result)\n        })\n    },[])\n    const folloUser = ()=>{\n        fetch('/follow',{\n            method:\"put\",\n            body:JSON.stringify({\n                followId:userid\n                }),\n            headers:{\n                \"Content-Type\":\"application/json\",\n                \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\n\n            }\n            \n        }).then(res=>res.json())\n        .then(data=>{\n            console.log(data)\n            dispatch({type:\"UPDATE\",payload:{following:data.following,followers:data.followers}})\n            localStorage.setItem(\"user\",JSON.stringify(data))\n            setProfile((prevState) => {\n                return {\n                  ...prevState,\n                  user: {\n                    ...prevState.user,\n                    followers: [...prevState.user.followers, data._id],\n                  },\n                };\n              });\n        })\n        setShowFollow(false)\n    }\n    const unfolloUser = ()=>{\n        fetch('/unfollow',{\n            method:\"put\",\n            body:JSON.stringify({\n                unfollowId:userid\n                }),\n            headers:{\n                \"Content-Type\":\"application/json\",\n                \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\n\n            }\n            \n        }).then(res=>res.json())\n        .then(data=>{\n            console.log(data)\n            dispatch({type:\"UPDATE\",payload:{following:data.following,followers:data.followers}})\n            localStorage.setItem(\"user\",JSON.stringify(data))\n            setProfile((prevState) => {\n                const updatedFollowers = prevState.user.followers.filter(\n                  (followerId) => followerId !== data._id\n                );\n              \n                return {\n                  ...prevState,\n                  user: {\n                    ...prevState.user,\n                    followers: updatedFollowers,\n                  },\n                };\n              });\n        })\n        setShowFollow(true)\n        \n    }\n    return(\n        <>\n        {userProfile ? \n        <div style={{maxWidth:\"550px\",margin:\"0px auto\"}}>\n        <div style={{\n            display: 'flex',\n            justifyContent:\"space-around\",\n            margin:\"18px 0px\",\n            borderBottom:\"1px solid grey\"\n        }}>\n            <div>\n                <img style={{width:\"160px\",height:\"160px\",borderRadius:\"80px\"}}\n                src={userProfile.user.pic} />\n            </div>\n            <div>\n             <h4>{userProfile.user.name}</h4>\n             <h5>{userProfile.user.email}</h5>\n                <div style={{display:\"flex\",justifyContent:\"space-between\",width:\"108%\"}}>\n                    <h5>40 Posts</h5>\n                    <h5>{userProfile.user.followers.length} folowers</h5>\n                    <h5>{userProfile.user.following.length} following</h5>\n                </div>\n                \n                {\n                    userProfile.user.followers.includes(user._id) ? (\n                        <button\n                        style={{ margin: \"10px\" }}\n                        className=\"btn waves-effect waves-light #64b5f6 blue darken-1\"\n                        onClick={() => unfolloUser()}\n                        >\n                        Unfollow\n                        </button>\n                    ) : (\n                        <button\n                        style={{ margin: \"10px\" }}\n                        className=\"btn waves-effect waves-light #64b5f6 blue darken-1\"\n                        onClick={() => folloUser()}\n                        >\n                        Follow\n                        </button>\n                    )\n                    }\n                \n            </div>\n        </div>\n        <div className=\"gallery\">\n            {\n                userProfile.posts.map(item=>{\n                    return(\n                        <img key={item._id} className=\"item\" src={item.photo} alt={item.title}/> \n                    )\n                })\n            }\n          \n          \n          \n        </div>\n    </div>\n        : <h2>loading...!</h2>}\n        </>\n    )\n}\n\nexport default Profile;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}