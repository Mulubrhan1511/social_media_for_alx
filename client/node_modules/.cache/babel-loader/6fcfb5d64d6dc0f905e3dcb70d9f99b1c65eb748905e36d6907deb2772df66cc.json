{"ast":null,"code":"import _objectSpread from\"/home/mulubrhan/alx/social_media_for_alx/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/mulubrhan/alx/social_media_for_alx/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import{Link}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Home=function Home(){var user=JSON.parse(localStorage.getItem(\"user\"));var _useState=useState([]),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];useEffect(function(){fetch('/allpost',{headers:{\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")}}).then(function(res){return res.json();}).then(function(result){setData(result.posts);});},[]);var likepost=function likepost(id){fetch(\"/like\",{method:'put',headers:{\"Authorization\":\"Bearer \"+localStorage.getItem('jwt'),\"Content-Type\":\"application/json\"},body:JSON.stringify({postId:id})}).then(function(res){return res.json();}).then(function(result){var newData=data.map(function(item){if(item._id===result._id){return _objectSpread(_objectSpread({},item),{},{likes:result.likes});}else{return item;}});setData(newData);});};var unlikepost=function unlikepost(id){fetch(\"/unlike\",{method:'put',headers:{\"Authorization\":\"Bearer \"+localStorage.getItem('jwt'),\"Content-Type\":\"application/json\"},body:JSON.stringify({postId:id})}).then(function(res){return res.json();}).then(function(result){var newData=data.map(function(item){if(item._id===result._id){return _objectSpread(_objectSpread({},item),{},{likes:result.likes});}else{return item;}});setData(newData);});};var makeComment=function makeComment(text,postId){fetch('/comment',{method:'put',headers:{'Authorization':'Bearer '+localStorage.getItem('jwt'),'Content-Type':'application/json'},body:JSON.stringify({postId:postId,text:text})}).then(function(res){return res.json();}).then(function(result){console.log(result);var newData=data.map(function(item){if(item._id===result._id){// Update the post with the new comment\nreturn _objectSpread(_objectSpread({},item),{},{comments:result.comments});}else{return item;}});setData(newData);});};var deletePost=function deletePost(postId){fetch(\"/deletepost/\".concat(postId),{method:\"delete\",headers:{'Authorization':'Bearer '+localStorage.getItem('jwt')}}).then(function(res){return res.json();}).then(function(result){console.log(result);if(result.error){// Handle error response, if any\nconsole.log(result.error);}else{// Remove the deleted post from the UI\nsetData(data.filter(function(item){return item._id!==postId;}));}}).catch(function(err){console.log(err);});};return/*#__PURE__*/_jsx(\"div\",{className:\"home\",children:data.map(function(item){return/*#__PURE__*/_jsxs(\"div\",{className:\"card home-card\",children:[/*#__PURE__*/_jsxs(\"h5\",{style:{padding:\"6px\"},children:[/*#__PURE__*/_jsx(Link,{to:item.postedBy._id!==user._id?\"/profile/\"+item.postedBy._id:\"/profile/\",children:item.postedBy.name}),item.postedBy._id===user._id&&/*#__PURE__*/_jsx(\"button\",{className:\"btn-floating btn-small waves-effect waves-light red\",style:{float:\"right\"},onClick:function onClick(){return deletePost(item._id);},children:/*#__PURE__*/_jsx(\"i\",{className:\"material-icons\",children:\"delete\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-image\",children:/*#__PURE__*/_jsx(\"img\",{alt:\"\",src:item.photo})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"material-icons\",style:{color:\"red\"},children:\"favorite\"}),item.likes.includes(user._id)?/*#__PURE__*/_jsx(\"button\",{className:\"unlike-button\",onClick:function onClick(){return unlikepost(item._id);},children:/*#__PURE__*/_jsx(\"i\",{className:\"material-icons\",children:\"thumb_down\"})}):/*#__PURE__*/_jsx(\"button\",{className:\"like-button\",onClick:function onClick(){return likepost(item._id);},children:/*#__PURE__*/_jsx(\"i\",{className:\"material-icons\",children:\"thumb_up\"})}),/*#__PURE__*/_jsxs(\"h6\",{children:[item.likes.length,\" likes\"]}),/*#__PURE__*/_jsx(\"h6\",{children:item.title}),/*#__PURE__*/_jsx(\"p\",{children:item.body}),item.comments.map(function(record){return/*#__PURE__*/_jsxs(\"h6\",{children:[/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:\"500\"},children:record.postedBy.name}),record.text]},record._id);}),/*#__PURE__*/_jsx(\"form\",{onSubmit:function onSubmit(e){e.preventDefault();makeComment(e.target[0].value,item._id);},children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"add a comment\"})})]})]},item._id);})});};export default Home;","map":{"version":3,"names":["React","useEffect","useState","Link","jsx","_jsx","jsxs","_jsxs","Home","user","JSON","parse","localStorage","getItem","_useState","_useState2","_slicedToArray","data","setData","fetch","headers","then","res","json","result","posts","likepost","id","method","body","stringify","postId","newData","map","item","_id","_objectSpread","likes","unlikepost","makeComment","text","console","log","comments","deletePost","concat","error","filter","catch","err","className","children","style","padding","to","postedBy","name","float","onClick","alt","src","photo","color","includes","length","title","record","fontWeight","onSubmit","e","preventDefault","target","value","type","placeholder"],"sources":["/home/mulubrhan/alx/social_media_for_alx/client/src/components/screens/Home.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport {Link} from 'react-router-dom'\n\nconst Home = ()=>{\n    const user = JSON.parse(localStorage.getItem(\"user\"))\n    const [data,setData] = useState([])\n    useEffect(()=>{\n        fetch('/allpost',{\n            headers:{\n                \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\n            }\n        }).then(res=>res.json())\n        .then(result=>{\n            setData(result.posts)\n        })\n    },[])\n    const likepost = (id) => {\n        fetch(\"/like\", {\n          method: 'put',\n          headers: {\n            \"Authorization\": \"Bearer \" + localStorage.getItem('jwt'),\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            postId: id\n          })\n        }).then(res => res.json())\n          .then(result => {\n            const newData = data.map(item => {\n              if (item._id === result._id) {\n                return { ...item, likes: result.likes };\n              } else {\n                return item;\n              }\n            });\n            setData(newData);\n          });\n      };\n      \n      const unlikepost = (id) => {\n        fetch(\"/unlike\", {\n          method: 'put',\n          headers: {\n            \"Authorization\": \"Bearer \" + localStorage.getItem('jwt'),\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            postId: id\n          })\n        }).then(res => res.json())\n          .then(result => {\n            const newData = data.map(item => {\n              if (item._id === result._id) {\n                return { ...item, likes: result.likes };\n              } else {\n                return item;\n              }\n            });\n            setData(newData);\n          });\n      };\n      const makeComment = (text, postId) => {\n        fetch('/comment', {\n          method: 'put',\n          headers: {\n            'Authorization': 'Bearer ' + localStorage.getItem('jwt'),\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n            postId,\n            text,\n          }),\n        })\n          .then((res) => res.json())\n          .then((result) => {\n            console.log(result);\n            const newData = data.map((item) => {\n              if (item._id === result._id) {\n                // Update the post with the new comment\n                return { ...item, comments: result.comments };\n              } else {\n                return item;\n              }\n            });\n            setData(newData);\n          });\n      };\n      const deletePost = (postId) => {\n        fetch(`/deletepost/${postId}`, {\n          method: \"delete\",\n          headers: {\n            'Authorization': 'Bearer ' + localStorage.getItem('jwt')\n          }\n        })\n          .then(res => res.json())\n          .then(result => {\n            console.log(result);\n            if (result.error) {\n              // Handle error response, if any\n              console.log(result.error);\n            } else {\n              // Remove the deleted post from the UI\n              setData(data.filter(item => item._id !== postId));\n            }\n          })\n          .catch(err => {\n            console.log(err);\n          });\n      };\n      \n    return(\n        <div className=\"home\">\n            {\n                data.map(item=>{\n                    return (\n                        <div className=\"card home-card\" key={item._id}>\n                        <h5 style={{padding:\"6px\"}}><Link to={item.postedBy._id !== user._id?\"/profile/\"+item.postedBy._id:\"/profile/\" }>{item.postedBy.name}</Link>{item.postedBy._id === user._id \n                        && <button\n                        className=\"btn-floating btn-small waves-effect waves-light red\"\n                        style={{ float: \"right\" }}\n                        onClick={() => deletePost(item._id)}\n                      >\n                        <i className=\"material-icons\">delete</i>\n                      </button>\n                        }</h5>\n                        <div className=\"card-image\"> \n                            <img alt=\"\" src={item.photo} />\n                        </div>\n                        <div className=\"card-content\">\n                        <i className=\"material-icons\" style={{color:\"red\"}}>favorite</i>\n                        {item.likes.includes(user._id) ? (\n                          <button className=\"unlike-button\" onClick={() => unlikepost(item._id)}>\n                            <i className=\"material-icons\">thumb_down</i>\n                          </button>\n                        ) : (\n                          <button className=\"like-button\" onClick={() => likepost(item._id)}>\n                            <i className=\"material-icons\">thumb_up</i>\n                          </button>\n                        )}\n                        <h6>{item.likes.length} likes</h6>\n                            <h6>{item.title}</h6>\n                            <p>{item.body}</p>\n                            {\n                              item.comments.map(record=>{\n                                return(\n                                  <h6 key={record._id}><span style={{fontWeight:\"500\"}}>{record.postedBy.name}</span>{record.text}</h6>\n                                )\n                              })\n                            }\n                            <form onSubmit={(e)=>{\n                              e.preventDefault()\n                              makeComment(e.target[0].value,item._id)\n                            }}>\n                            <input type=\"text\" placeholder=\"add a comment\"/>\n                            </form>\n                            \n                        </div>\n                    </div>\n                    )\n                })\n            }\n            \n            \n        </div>\n    )}\n\nexport default Home;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}